Elements of metacommunity structure
-------------------------------------

The EMS paradigm follows a step-wise procedure to determine which of twelve potential metacommunity structures are exhibited by a data set of species occurrences observed across multiple sites. Although the procedure can determine that no orderly structure exists (i.e. random structure), most metacommunities seem to exhibit detectable structure [@Leibold2002]. In this section we will only briefly describe these methods, as others have done a more thorough job elsewhere [@Leibold2002; @Presley2010]. 

First, species occurrence data are assembled into a site x species incidence matrix with rows as sites and columns as species. This matrix is then ordinated, typically using reciprocal averaging, to simultaneously group sites with common species assemblages and species with common distributions among sites. This ordinated incidence matrix theoretically represents how species assemblages are structured along a dominant environmental axis (i.e. gradient) across sites. From this matrix statistics are then calculated to summarize the elements of metacommunity structure. 

The first and most important metric of metacommunity structure is coherence, which represents whether the majority of species in the metacommunity respond to the same enviornmental axis of variation as a cohesive unit, the foundation of structure. Coherence is estimated using the number of embedded absences in the ordinated matrix. Embedded absences occur in areas of the matrix where a species is absent in a site in which it would be expected to occur based on the ordination. The observed number of embedded absences are then compared to a null distribution of embedded absences generated from simulated matrices. When the metacommunity exhibits fewer embedded absences than expected from random chance (as defined by the chosen method of generating null matrices), the metacommunity is said to exhibit positive coherence. If the metacommunity has more embedded absences than expected, there is evidence for a checkerboard pattern. Finally, if the number of embedded absences is not significantly different from random, the metacommunity is not coherent and exhibits no discernible structure. This is often interpreted as meaning that species in the metacommunity respond to different dominant environmental gradients or that the size of the matrix (in terms of the number of sites or species or observed occurrences within the matrix) is too small to detect patterns.

If a metacommunity exhibits positive coherence, two more metrics are calculated to further describe the metacommunity structure, the first being turnover. Turnover represents how species composition changes along the theoretical environmental gradient, estimated using the number of species replacements observed in the ordinated matrix. Again, this observed number is compared to a distribution generated by null matrices. If the number of replacements is fewer than expected, which is indicative of nested subsets. If the number of replacements is greater than expected, the metacommunity exhibits positive turnover, which must be futher analyzed (below).

Boundary clumping, estimated with Morista's index, helps to further distinguish structures. If a metacommunity is positively coherent, has positive turnover, and there is positive boundary clumping, then the metacommunity is said to exhibit a Clementsian structure [@Clements1916; @Gilpin1982]. Alternatively, if there is no discernible boundary clumping, the metacommunity is said to exhibit a Gleasonian structure, where species respond idiosyncratically to the environmental gradient [@Gleason1926]. Finally, if there is positive coherence, but no significant turnover, various quasi-structures are assigned to the metacommunity, depending on the trend observed in turnover and boundary clumping [*sensu* @Presley2010]. 

After the metacommunity structure is discerned using the three metrics above, studies typically seek to determine which environmental covariates might be driving the primary axis of variation in the ordinated community. This analysis takes various forms. In most cases, the ordination score of the primary axis is extracted for each sampled site. Then univariate correlation tests are run for each covariate of interest, and subsequently researchers theorize how significantly correlated covariates might be responsible for structuring the metacommunity [e.g. @Henriques-Silva2013; @Meynard2013]. Another, related approach is to use, for example, canonical correspondence analysis to relate site compositions to multiple covariates simultaneously [e.g. @Lopez-Gonzalez2012]. A more recent approach is to combine one of these previously discussed analyses with a variance partitioning analysis to evaluate the relative contribution of classes of covariates, such as 'local' and 'spatial' or 'abiotic' and 'biotic' [@Henriques-Silva2013] to species compositions across sites. 

Although these methods have yielded various insights into the structuring of metacommunities, at each step of this process, there are problems that can arise due to the methods themselves, such as type I error inflation, or due to inherent issues in data quality, such as detection errors. Below, we will briefly describe the structure of multi-species occupancy models, which estimate detection and occurrence probabilities and associate these probabilities with covariates, all within the same model. After this, we will highlight various issues with the EMS paradigm that can be ameliorated using occupancy modeling.
